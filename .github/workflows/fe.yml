name: Deploy to Somee via FTP

on:
  push:
    branches:
      - main   # Nhánh bạn muốn deploy

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      # Bước 1: Lấy mã nguồn từ repository
      - name: Checkout code
        uses: actions/checkout@v2

      # Bước 2: Cài đặt FTP client (lftp)
      - name: Install lftp
        run: sudo apt-get install lftp

      # Bước 3: Thiết lập thông tin FTP (server, user, password) và upload
      - name: Deploy via FTP
        env:
          FTP_HOST: ${{ secrets.HOST }}
          FTP_USER: ${{ secrets.USER }}
          FTP_PASSWORD: ${{ secrets.PW }}
        run: |
          lftp -u $FTP_USER,$FTP_PASSWORD $FTP_HOST <<EOF
          lcd .
          cd /public_html/          # Thư mục đích trên Somee (đổi nếu khác)
          mirror -R ./ ./ --ignore-time --verbose
          quit
          EOF
